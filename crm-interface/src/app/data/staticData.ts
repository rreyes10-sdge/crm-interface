import { ProjectRow } from '../types';

export const projectData: ProjectRow[] = [
  {
    ProjectNumber: 'TE245001',
    ProjectId: '3204',
    ProjectName: '224 S Las Posas Rd',
    OrganizationName: 'EDCO Waste and Recycling',
    OrganizationId: '2261',
    ProjectStatus: 'Complete',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 5,
    ServicesCompleted: 5,
    ServicesInProgress: 0,
    OpenServices: 0,
    ServicesNotReady: 0,
    PercentCompleted: 100
  },
  {
    ProjectNumber: 'TE245002',
    ProjectId: '3211',
    ProjectName: '15500 San Pasqual Valley Road',
    OrganizationName: 'San Diego Zoo Wildlife Alliance',
    OrganizationId: '651',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 14,
    ServicesCompleted: 3,
    ServicesInProgress: 4,
    OpenServices: 11,
    ServicesNotReady: 7,
    PercentCompleted: 21.43
  },
  {
    ProjectNumber: 'TE245003',
    ProjectId: '3223',
    ProjectName: '160 Calle Magdalena',
    OrganizationName: 'City of Encinitas',
    OrganizationId: '324',
    ProjectStatus: 'Canceled',
    ProjectLead: 'Eva Brungardt',
    USC: false,
    TotalServicesSelected: 5,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 5,
    ServicesNotReady: 5,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245004',
    ProjectId: '3235',
    ProjectName: '4030 Sorrento Valley Blvd. STE A',
    OrganizationName: 'Patterson Companies',
    OrganizationId: '2273',
    ProjectStatus: 'Canceled',
    ProjectLead: 'Eva Brungardt',
    USC: false,
    TotalServicesSelected: 6,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 6,
    ServicesNotReady: 6,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245005',
    ProjectId: '3237',
    ProjectName: '4927 Oceanside Blvd',
    OrganizationName: 'Oceanside Police Department -City of Oceanside CA',
    OrganizationId: '2275',
    ProjectStatus: 'Canceled',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 13,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 13,
    ServicesNotReady: 13,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245006',
    ProjectId: '3252',
    ProjectName: '5950 El Camino Real',
    OrganizationName: 'City of Carlsbad',
    OrganizationId: '21',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: false,
    TotalServicesSelected: 9,
    ServicesCompleted: 1,
    ServicesInProgress: 4,
    OpenServices: 8,
    ServicesNotReady: 4,
    PercentCompleted: 11.11
  },
  {
    ProjectNumber: 'TE245007',
    ProjectId: '3266',
    ProjectName: '10440 Black Mountain Rd',
    OrganizationName: 'Renewable Properties',
    OrganizationId: '2290',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 3,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 3,
    ServicesNotReady: 3,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245008',
    ProjectId: '3273',
    ProjectName: '1140 W Mission Rd',
    OrganizationName: 'Palomar Community College District',
    OrganizationId: '941',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 6,
    ServicesCompleted: 2,
    ServicesInProgress: 2,
    OpenServices: 4,
    ServicesNotReady: 2,
    PercentCompleted: 33.33
  },
  {
    ProjectNumber: 'TE245009',
    ProjectId: '3279',
    ProjectName: '4927 Oceanside Blvd - 2',
    OrganizationName: 'City of Oceanside',
    OrganizationId: '19',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 15,
    ServicesCompleted: 2,
    ServicesInProgress: 2,
    OpenServices: 13,
    ServicesNotReady: 11,
    PercentCompleted: 13.33
  },
  {
    ProjectNumber: 'TE245010',
    ProjectId: '3378',
    ProjectName: '1111 6th Ave Ste 550',
    OrganizationName: 'Toast Doctor LLC',
    OrganizationId: '2376',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 11,
    ServicesCompleted: 2,
    ServicesInProgress: 0,
    OpenServices: 9,
    ServicesNotReady: 9,
    PercentCompleted: 18.18
  },
  {
    ProjectNumber: 'TE245011',
    ProjectId: '3392',
    ProjectName: '31641 La Novia Ave',
    OrganizationName: 'EVPV LLC',
    OrganizationId: '2382',
    ProjectStatus: 'Canceled',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 6,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 6,
    ServicesNotReady: 6,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245012',
    ProjectId: '3410',
    ProjectName: 'Anderson Plumbing Heating and Air',
    OrganizationName: 'Anderson Plumbing, Heating and Air',
    OrganizationId: '165',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 7,
    ServicesCompleted: 1,
    ServicesInProgress: 1,
    OpenServices: 6,
    ServicesNotReady: 5,
    PercentCompleted: 14.29
  },
  {
    ProjectNumber: 'TE245013',
    ProjectId: '3444',
    ProjectName: 'San Diego Unified School District',
    OrganizationName: 'San Diego Unified School District',
    OrganizationId: '57',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 3,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 3,
    ServicesNotReady: 3,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245014',
    ProjectId: '3452',
    ProjectName: 'Rainbow Municipal Water District',
    OrganizationName: 'Rainbow Municipal Water District',
    OrganizationId: '411',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 11,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 11,
    ServicesNotReady: 11,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245018',
    ProjectId: '3480',
    ProjectName: 'RedBull',
    OrganizationName: 'RedBull',
    OrganizationId: '650',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: false,
    TotalServicesSelected: 5,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 5,
    ServicesNotReady: 5,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245019',
    ProjectId: '3486',
    ProjectName: 'San Pasqual Union School District',
    OrganizationName: 'San Pasqual Union School District',
    OrganizationId: '850',
    ProjectStatus: 'Active',
    ProjectLead: 'Eva Brungardt',
    USC: false,
    TotalServicesSelected: 4,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 4,
    ServicesNotReady: 4,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245011',
    ProjectId: '3391',
    ProjectName: '31641 La Novia Ave',
    OrganizationName: 'EVPV LLC',
    OrganizationId: '2382',
    ProjectStatus: 'Ineligible',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 6,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 6,
    ServicesNotReady: 6,
    PercentCompleted: 0
  },
  {
    ProjectNumber: 'TE245005',
    ProjectId: '3237',
    ProjectName: '4927 Oceanside Blvd',
    OrganizationName: 'Oceanside Police Department -City of Oceanside CA',
    OrganizationId: '2275',
    ProjectStatus: 'Duplicate',
    ProjectLead: 'Eva Brungardt',
    USC: true,
    TotalServicesSelected: 13,
    ServicesCompleted: 0,
    ServicesInProgress: 0,
    OpenServices: 13,
    ServicesNotReady: 13,
    PercentCompleted: 0
  }
];

export const getProjectStatusCounts = async () => {
  let data;

  try {
    const response = await fetch('http://127.0.0.1:5000/api/data/summary'); // Replace with your API endpoint
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    data = await response.json();
  } catch (error) {
    console.error('Failed to fetch data from API, using static data:', error);
    data = projectData; // Fallback to static data
  }

  interface ProjectStatusCounts {
    [key: string]: number;
  }

  const statusCounts: ProjectStatusCounts = data.reduce((acc: ProjectStatusCounts, project: ProjectRow) => {
    acc[project.ProjectStatus] = (acc[project.ProjectStatus] || 0) + 1;
    return acc;
  }, {} as ProjectStatusCounts);

  return [
    { status: 'Active', value: statusCounts['Active'] || 0 },
    { status: 'Complete', value: statusCounts['Complete'] || 0 },
    { status: 'Canceled', value: statusCounts['Canceled'] || 0 },
    { status: 'Ineligible', value: statusCounts['Ineligible'] || 0 },
    { status: 'Duplicate', value: statusCounts['Duplicate'] || 0 },
  ];
};